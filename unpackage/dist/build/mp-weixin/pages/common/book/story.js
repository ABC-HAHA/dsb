(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/common/book/story"],{"0be8":function(t,e,s){},"6c2d":function(t,e,s){"use strict";s.r(e);var o=s("c0d2"),a=s("a2ba");for(var i in a)"default"!==i&&function(t){s.d(e,t,function(){return a[t]})}(i);s("d41b");var n=s("2877"),r=Object(n["a"])(a["default"],o["a"],o["b"],!1,null,"f20375c8",null);e["default"]=r.exports},a23a:function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(s("4179")),a=i(s("8892"));function i(t){return t&&t.__esModule?t:{default:t}}var n=function(){return s.e("pages/components/sharePop").then(s.bind(null,"52ba"))},r=function(){return s.e("pages/components/rechargePop").then(s.bind(null,"abff"))},c={components:{sharePop:n,rechargePop:r},data:function(){return{animationHeader:{},animTxt:{},animMenu:{},moreIsShow:!1,showHF:!1,story:{},rechargeShow:!1,isMenuShow:!1,shareShow:!1,curChapter:1,chaptersList:[],menuX:0,menuEndX:0,menu_x:0,showBuyBtn:!1,lists:[],share_url:"",share_title:"",share_content:"",isLogin:this.$store.state.isLogin,second:0}},onShareAppMessage:function(t){var e=this.storyData.source_id,s=this.storyData.ncontent,o=this.storyData.pic;this.storyData.url;return{title:s,path:"/pages/common/book/storyDetail?id="+e,imageUrl:o}},onLoad:function(){var e=this,s=this.$store.state.bookId,a="";if(this.isLogin)a=JSON.parse(t.getStorageSync("userInfo")).id;else a=0;t.request({url:o.default.HTTP+"/novel/getnovel",method:"POST",data:{novelid:s,uid:a},success:function(t){e.story=t.data.novel[0],e.share_url=e.story.url,e.share_title=e.story.title,e.share_content=e.story.ncontent,e.comment=t.data.comment,e.comments=t.data.comment.slice(0,3),e.other=t.data.othernovel,e.others=t.data.othernovel.slice(0,4),e.similar=t.data.similarnovel,e.similars=t.data.similarnovel.slice(0,4),e.$store.dispatch("comments",t.data.comment),e.$store.dispatch("story",e.story)}}),0===this.$store.state.storyData.isbuy&&(this.showBuyBtn=!0),t.request({url:o.default.HTTP+"/Generalize/moneylist",method:"POST",success:function(t){e.lists=t.data.money}}),this.timer=setInterval(function(){if(e.second=Number(e.second)+1,9==e.v_time){var t=Date.parse(e.scroll_time)-Date.parse(e.start_time);t<e.old_time&&clearInterval(e.timer)}if(9==e.v_time){t=Date.parse(e.scroll_time)-Date.parse(e.start_time);t<e.old_time&&clearInterval(e.timer)}},1e3)},onShow:function(){var e=this,s=this.$store.state.bookId,a="";a=this.isLogin?JSON.parse(t.getStorageSync("userInfo")).id:0,t.request({url:o.default.HTTP+"/novel/getnovel",method:"POST",data:{novelid:s,uid:a},success:function(t){e.story=t.data.novel[0],e.comment=t.data.comment,e.comments=t.data.comment.slice(0,3),e.other=t.data.othernovel,e.others=t.data.othernovel.slice(0,4),e.similar=t.data.similarnovel,e.similars=t.data.similarnovel.slice(0,4),e.$store.dispatch("comments",t.data.comment),e.$store.dispatch("story",e.story)}});var i=t.createAnimation({duration:500,timingFunction:"ease"});this.animation=i},onPageScroll:function(t){},onUnload:function(){if(this.timer&&(clearInterval(this.timer),this.timer=null),this.isLogin){var e=JSON.parse(t.getStorageSync("userInfo")).id;t.request({url:o.default.HTTP+"/novel/getreadtime",method:"POST",data:{uid:e,time:this.second},success:function(t){}})}},onBackPress:function(){if(this.shareObj.shareMenu.isVisible())return this.shareObj.shareMenu.hide(),this.shareObj.alphaBg.hide(),!0},onReachBottom:function(){console.log("这是触底加载"),this.goNext(),console.log("触底加载完毕")},methods:{shareInfo:function(){var e=this,s={href:this.share_url,title:this.share_title,desc:this.share_content},i=[{icon:"/static/sharemenu/wx.png",text:"微信好友"},{icon:"/static/sharemenu/pyq.png",text:"朋友圈"},{icon:"/static/sharemenu/qq.png",text:"QQ"},{icon:"/static/sharemenu/copy.png",text:"复制"},{icon:"/static/sharemenu/more.png",text:"更多"}];this.shareObj=(0,a.default)(s,i,function(e){console.log("点击按钮的序号: "+e);var a={href:s.href||"",title:s.title||"",summary:s.desc||"",success:function(e){var s=t.getStorageSync("userInfo"),a="";a=s?JSON.parse(s).id:0,t.request({url:o.default.HTTP+"/share/novelshare",method:"POST",data:{uid:a},success:function(t){}}),console.log("success:"+JSON.stringify(e))},fail:function(t){console.log("fail:"+JSON.stringify(t))}};switch(e){case 0:a.provider="weixin",a.scene="WXSceneSession",a.type=0,a.imageUrl=s.imgUrl||"",t.share(a);break;case 1:a.provider="weixin",a.scene="WXSenceTimeline",a.type=0,a.imageUrl=s.imgUrl||"",t.share(a);break;case 2:a.provider="qq",a.type=1,a.imageUrl=s.imgUrl||"",t.share(a);break;case 3:t.setClipboardData({data:s.href,complete:function(){t.showToast({title:"已复制到剪贴板"})}});break;case 4:plus.share.sendWithSystem({type:"web",title:s.title||"",thumbs:[s.imgUrl||""],href:s.href||"",content:s.desc||""});break}}),this.$nextTick(function(){e.shareObj.alphaBg.show(),e.shareObj.shareMenu.show()})},goNext:function(){var e=this,s=this.storyData.next.id,a="";a=this.isLogin?JSON.parse(t.getStorageSync("userInfo")).id:0;var i=this.storyData.source_id;s?(t.showLoading({title:"loading...",mask:!0}),t.request({url:o.default.HTTP+"/novel/getnovelcontent",method:"POST",data:{id:i,key:s,uid:a},success:function(s){e.$store.dispatch("storyData",s.data),t.pageScrollTo({scrollTop:0,duration:1e3}),t.hideLoading(),0===s.data.isbuy&&(e.showBuyBtn=!0)}})):t.showToast({title:"已经是最后一章了",icon:"none"})},buyIt:function(){var e=this;if(0==this.$store.state.isLogin)t.showModal({title:"提示",content:"您还没有登录，是否登录？",success:function(e){e.confirm&&t.navigateTo({url:"../login"})}});else{var s=this.storyData.id,a="";a=this.isLogin?JSON.parse(t.getStorageSync("userInfo")).id:0;var i=this.storyData.source_id,n=this.storyData.price;t.request({url:o.default.HTTP+"/novel/buynovelchapter",method:"POST",data:{id:i,key:s,price:n,uid:a},success:function(s){1===s.data.code?e.rechargeShow=!0:0===s.data.code&&(e.$store.dispatch("storyData",s.data.data),t.pageScrollTo({scrollTop:0,duration:300}),e.showBuyBtn=!1)}})}},goPrev:function(){var e=this,s=this.storyData.prev.id,a=this.storyData.source_id,i="";i=this.isLogin?JSON.parse(t.getStorageSync("userInfo")).id:0,s?t.request({url:o.default.HTTP+"/novel/getnovelcontent",method:"POST",data:{id:a,key:s,uid:i},success:function(s){e.$store.dispatch("storyData",s.data),t.pageScrollTo({scrollTop:0,duration:300})}}):t.showToast({title:"已经是第一章了",icon:"none"})},menuStart:function(t){this.menuX=t.touches[0].pageX},menuMove:function(t){this.menuEndX=t.changedTouches[0].pageX},menuEnd:function(t){this.menu_x=this.menuEndX-this.menuX,this.menu_x<-10&&(this.animation.left("-100%").step(),this.animMenu=this.animation.export())},showMore:function(){this.moreIsShow=!this.moreIsShow},centerShow:function(){this.showHF=!this.showHF,this.moreIsShow=!1,this.animation.translateY(0,66).step(),this.animationHeader=this.animation.export()},showMenu:function(){var e=this;this.animation.left(0).step(),this.animMenu=this.animation.export(),this.showHF=!1,t.showLoading({mask:!0,title:"正在加载"});var s=this.storyData.novel_id;console.log(s);var a="";a=this.isLogin?JSON.parse(t.getStorageSync("userInfo")).id:0;var i=this.curChapter;t.request({url:o.default.HTTP+"/novel/getchapterlist",method:"POST",data:{id:this.storyData.novel_id,uid:a,pagesize:200,pagenum:i},success:function(s){console.log(s),e.story=s.data,e.chaptersList=s.data.chapter,t.hideLoading()}})},moreChapter:function(){var e=this;t.showLoading({mask:!0,title:"正在加载"});var s=this.storyData.novel_id;console.log(s);var a="";a=this.isLogin?JSON.parse(t.getStorageSync("userInfo")).id:0,this.curChapter++;var i=this.curChapter;t.request({url:o.default.HTTP+"/novel/getchapterlist",method:"POST",data:{id:s,uid:a,pagesize:200,pagenum:i},success:function(s){e.chaptersList=s.data.chapter,t.hideLoading(),1===s.data.islast&&t.showToast({title:"已经到底啦",icon:"none"})}})},download:function(){var e=this.$store.state.bookId;t.downloadFile({url:o.default.HTTP+"/novel/noveldownload1?novelid="+e,success:function(e){console.log(e),200===e.statusCode&&t.saveFile({tempFilePath:e.tempFilePath,success:function(e){t.showToast({title:"保存成功："+e.savedFilePath,icon:"none"})}})}})},goComment:function(){var e=this,s=this.storyData.novel_id,a="";a=this.isLogin?JSON.parse(t.getStorageSync("userInfo")).id:0,t.request({url:o.default.HTTP+"/novel/getnovel",method:"POST",data:{novelid:s,uid:a},success:function(s){e.$store.dispatch("comments",s.data.comment),t.navigateTo({url:"allComments"})}})},goChapter:function(e){var s=this;this.isMenuShow=!1;var a=this.storyData.source_id,i=e.id,n="";n=this.isLogin?JSON.parse(t.getStorageSync("userInfo")).id:0,t.request({url:o.default.HTTP+"/novel/getnovelcontent",method:"POST",data:{id:a,key:i,uid:n},success:function(e){s.$store.dispatch("storyData",e.data),t.redirectTo({url:"story"})}})},goDetail:function(){var e=this.storyData.novel_id;t.redirectTo({url:"storyDetail?id="+e})},closeSP:function(t){this.shareShow=t},closeRP:function(t){this.rechargeShow=t}},computed:{storyData:function(){return this.$store.state.storyData},contentData:function(){return this.storyData.content},updateTime:function(){var t=parseInt((new Date).getTime()/1e3),e=parseInt(t-this.story.update_time);return e<0?"1秒":e>=0&&e<60?e+"秒":e>=60&&e<3600?Math.ceil(e/60)+"分钟":e>=3600&&e<86400?Math.ceil(e/3600)+"小时":e>=86400&&e<2592e3?Math.ceil(e/86400)+"天":e>=2592e3&&e<31104e3?Math.ceil(e/2592e3)+"月":Math.ceil(e/31104e3)+"年"}}};e.default=c}).call(this,s("543d")["default"])},a2ba:function(t,e,s){"use strict";s.r(e);var o=s("a23a"),a=s.n(o);for(var i in o)"default"!==i&&function(t){s.d(e,t,function(){return o[t]})}(i);e["default"]=a.a},c0d2:function(t,e,s){"use strict";var o=function(){var t=this,e=t.$createElement;t._self._c},a=[];s.d(e,"a",function(){return o}),s.d(e,"b",function(){return a})},d41b:function(t,e,s){"use strict";var o=s("0be8"),a=s.n(o);a.a}},[["49fc","common/runtime","common/vendor"]]]);