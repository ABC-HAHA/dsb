(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/common/book/storyDetail"],{"0f91":function(t,e,o){},"39c4":function(t,e,o){"use strict";var s=o("0f91"),n=o.n(s);n.a},"5a7c":function(t,e,o){"use strict";o.r(e);var s=o("91fa"),n=o.n(s);for(var i in s)"default"!==i&&function(t){o.d(e,t,function(){return s[t]})}(i);e["default"]=n.a},"67eb":function(t,e,o){"use strict";var s=function(){var t=this,e=t.$createElement,o=(t._self._c,t.__map(t.comments,function(e,o){var s=t.hasUp(e.id);return{$orig:t.__get_orig(e),m0:s}}));t.$mp.data=Object.assign({},{$root:{l0:o}})},n=[];o.d(e,"a",function(){return s}),o.d(e,"b",function(){return n})},"91fa":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=i(o("4179")),n=i(o("8892"));function i(t){return t&&t.__esModule?t:{default:t}}var a=function(){return o.e("pages/components/wxInfoDialog").then(o.bind(null,"8270"))},r=function(){return o.e("pages/components/sharePop").then(o.bind(null,"52ba"))},c={components:{wxInfoDialog:a,sharePop:r},data:function(){return{showShare:!1,story:{},isLess:!0,comment:[],comments:[],other:[],others:[],animTitle:{},current:0,similar:[],similars:[],isTop:!1,showDialog:!1,share_url:"",share_title:"",share_content:"",advs:{},isLogin:this.$store.state.isLogin}},onLoad:function(e){var o=this,n=e.id;console.log(n);var i=t.getStorageSync("userInfo");console.log(i);var a="";i&&(a=JSON.parse(i).id),console.log(n+"++++++"+a),t.request({url:s.default.HTTP+"/novel/getnovel",method:"POST",data:{novelid:n,uid:a},success:function(t){o.story=t.data.novel[0],o.share_url=o.story.url,o.share_title=o.story.title,o.share_content=o.story.ncontent,o.comment=t.data.comment,o.comments=t.data.comment.slice(0,3),o.other=t.data.othernovel,o.others=t.data.othernovel.slice(0,4),o.similar=t.data.similarnovel,o.similars=t.data.similarnovel.slice(0,4),o.$store.dispatch("comments",t.data.comment),o.$store.dispatch("story",o.story)}}),this.adv()},onBackPress:function(){if(this.shareObj.shareMenu.isVisible())return this.shareObj.shareMenu.hide(),this.shareObj.alphaBg.hide(),!0},onShow:function(){var e=this,o=t.createAnimation({duration:1e3});this.animation=o;var n=this.$store.state.bookId,i=t.getStorageSync("userInfo"),a="";i&&(a=JSON.parse(i).id),console.log(n),t.request({url:s.default.HTTP+"/novel/getnovel",method:"POST",data:{novelid:n,uid:a},success:function(t){e.story=t.data.novel[0],e.comment=t.data.comment,e.comments=t.data.comment.slice(0,3),e.other=t.data.othernovel,e.others=t.data.othernovel.slice(0,4),e.similar=t.data.similarnovel,e.similars=t.data.similarnovel.slice(0,4),e.$store.dispatch("comments",t.data.comment),e.$store.dispatch("story",e.story)}})},onShareAppMessage:function(){var t=this.story.source_id;return{title:this.story.content,path:"/pages/common/book/storyDetail?id="+t,imageUrl:this.story.pic}},onPageScroll:function(t){t.scrollTop>20?(this.animation.opacity(1).step(),this.animTitle=this.animation.export()):t.scrollTop<20&&(this.animation.opacity(0).step(),this.animTitle=this.animation.export())},methods:{adv:function(){var e=this;t.request({url:s.default.HTTP+"/index/appad",method:"POST",data:{id:7},success:function(t){console.log(t),0==t.data.code&&1==t.data.advertisement[0].status?(t.data.advertisement[0].picpath=s.default.ImgUrl+t.data.advertisement[0].picpath,e.advs=t.data.advertisement[0]):e.advs=!1}})},shareInfo:function(){var e=this,o={href:this.share_url,title:this.share_title,desc:this.share_content},i=[{icon:"/static/sharemenu/wx.png",text:"微信好友"},{icon:"/static/sharemenu/pyq.png",text:"朋友圈"},{icon:"/static/sharemenu/qq.png",text:"QQ"},{icon:"/static/sharemenu/copy.png",text:"复制"},{icon:"/static/sharemenu/more.png",text:"更多"}];this.shareObj=(0,n.default)(o,i,function(e){console.log("点击按钮的序号: "+e);var n={href:o.href||"",title:o.title||"",summary:o.desc||"",success:function(e){var o=t.getStorageSync("userInfo"),n="";n=o?JSON.parse(o).id:0,t.request({url:s.default.HTTP+"/share/novelshare",method:"POST",data:{uid:n},success:function(t){}}),console.log("success:"+JSON.stringify(e))},fail:function(t){console.log("fail:"+JSON.stringify(t))}};switch(e){case 0:n.provider="weixin",n.scene="WXSceneSession",n.type=0,n.imageUrl=o.imgUrl||"",t.share(n);break;case 1:n.provider="weixin",n.scene="WXSenceTimeline",n.type=0,n.imageUrl=o.imgUrl||"",t.share(n);break;case 2:n.provider="qq",n.type=1,n.imageUrl=o.imgUrl||"",t.share(n);break;case 3:t.setClipboardData({data:o.href,complete:function(){t.showToast({title:"已复制到剪贴板"})}});break;case 4:plus.share.sendWithSystem({type:"web",title:o.title||"",thumbs:[o.imgUrl||""],href:o.href||"",content:o.desc||""});break}}),this.$nextTick(function(){e.shareObj.alphaBg.show(),e.shareObj.shareMenu.show()})},closepop:function(t){this.showShare=!1},seeTa:function(e){this.$store.dispatch("otherUser",e.user),t.navigateTo({url:"otherUserInfo"})},showMore:function(){this.isLess=!this.isLess},editReview:function(){t.navigateTo({url:"editReview"})},closeDialog:function(t){this.showDialog=t},qita:function(e){console.log(e),this.$store.dispatch("bookId",e),t.navigateTo({url:"storyDetail?id="+e})},readStory:function(){var e=this,o=this.story.id,n=t.getStorageSync("userInfo"),i="";n&&(i=JSON.parse(n).id),t.request({url:s.default.HTTP+"/novel/readnovel",method:"POST",data:{novel_id:o,uid:i},success:function(o){e.$store.dispatch("storyData",o.data),t.redirectTo({url:"story"})}})},goChapters:function(){this.$store.dispatch("pageTitle",this.story.title),t.navigateTo({url:"chapters"})},addToShelf:function(){var e=this,o=this.story.id;if(0==this.$store.state.isLogin)t.showModal({title:"提示",content:"您还没有登录，是否登录？",success:function(e){e.confirm&&t.navigateTo({url:"../login"})}});else{var n=t.getStorageSync("userInfo"),i="";n&&(i=JSON.parse(n).id),console.log(i),t.request({url:s.default.HTTP+"/Bookshelf/addbookshelf",method:"POST",data:{uid:i,novelid:o},success:function(o){0===o.data.code?(e.story.isbookshelf=0,t.showToast({title:"已成功加入书架",icon:"none"})):t.showToast({title:o.data.error})}})}},goDetail:function(e){console.log(e),this.$store.dispatch("comment",e),t.navigateTo({url:"commontDetail"})},thumbsUp:function(e){var o=e.id,n=t.getStorageSync("userInfo"),i="";n&&(i=JSON.parse(n).id);var a=e.user.id;this.current=o,t.request({url:s.default.HTTP+"/comment/upcomment",method:"POST",data:{cid:o,uid:i,fuid:a},success:function(o){0===o.data.code?e.up++:t.showToast({title:"请不要重复点赞",icon:"none"})}})},hasUp:function(t){return t===this.current},goAdv:function(t){this.advShow=!1,clearInterval(this.interval),clearTimeout(this.timeOut),plus.runtime.openURL(t)}},computed:{rate:function(){return Number(this.story.rating)},isSeeOne:function(){return this.others.length>4},id:function(){return t.getStorageSync("user").id},isAdd:function(){return 0===this.story.isbookshelf},urlHttp:function(){return s.default.UrlHttp}}};e.default=c}).call(this,o("543d")["default"])},ffec:function(t,e,o){"use strict";o.r(e);var s=o("67eb"),n=o("5a7c");for(var i in n)"default"!==i&&function(t){o.d(e,t,function(){return n[t]})}(i);o("39c4");var a=o("2877"),r=Object(a["a"])(n["default"],s["a"],s["b"],!1,null,"3b1e6561",null);e["default"]=r.exports}},[["e164","common/runtime","common/vendor"]]]);